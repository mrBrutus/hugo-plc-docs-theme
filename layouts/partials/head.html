<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>
    {{ block "title" . }}
      {{ .Title }}
    {{ end }}
  </title>

  {{ if .Description }}
    <meta name="description" content="{{ .Description }}" />
  {{ end }}
  {{ if .Keywords }}
    <meta name="keywords" content="{{ delimit .Keywords ',' }}" />
  {{ end }}
  {{ if .Params.Author }}
    <meta name="author" content="{{ .Params.Author}}" />
  {{ end }}
  {{ hugo.Generator }}

  {{ "<!--favicon-->" | safeHTML }}
  <link rel="shortcut icon" href="{{ `images/favicon.ico` | absURL }}" type="image/x-icon">
  <link rel="icon" href="{{ `images/favicon.ico` | absURL }}" type="image/x-icon">



  {{ "<!-- plugins -->" | safeHTML }}
  {{ range $plugin, $settings := $.Site.Data.plugins }}
    {{/* optional plugins are activated by site- or page parameter */}}
    {{ if (or (not .optional) (in $.Site.Params.plugins $plugin) (in $.Params.plugins $plugin)) }}
      {{ with .styles }}
        {{ range . }}
          {{/* CDN stylesheets */}}
          {{ if findRE "^http" .url }}
            <link
              rel="stylesheet"
              href="{{ .url | absURL }}"
              {{ with .media }}media="{{ . }}"{{end}}
              {{ with .id }}id="{{ . }}"{{end}}
            >

          {{/* served stylesheets */}}
          {{ else if .url }}
            {{ $singleCSS := resources.Get .url | minify | fingerprint "sha512" }}
            <link
              rel="stylesheet"
              href="{{ $singleCSS.RelPermalink }}"
              integrity="{{ $singleCSS.Data.Integrity }}"
              {{ with .media }}media="{{ . }}"{{end}}
              {{ with .id }}id="{{ . }}"{{end}}
            >
          {{ end }}
        {{ end }}
      {{ end }}

      {{ with .scripts.head }}
        {{ range . }}
          {{/* CDN scripts */}}
          {{ if findRE "^http" . }}
            <script src="{{ . | absURL }}"></script>
          {{/* served scripts */}}
          {{ else }}
            {{ $singleJS := resources.Get . | fingerprint "sha512" }}
            <script src="{{ $singleJS.RelPermalink }}" integrity="{{ $singleJS.Data.Integrity }}"></script>
          {{ end }}
        {{ end }}
      {{ end }}
    {{ end }}
  {{ end }}


  {{ "<!-- site stylesheet -->" | safeHTML }}
  {{ $allCSS := slice }}
  {{ $allCSS := $allCSS | append (resources.Get "css/styles.css" | postCSS (dict "config" "./assets/css/postcss.config.js") | minify ) }}
  {{ $allCSS := $allCSS | resources.Concat "/css/vendor.css" | minify | fingerprint "sha512" }}
  <link rel="stylesheet" href="{{ $allCSS.RelPermalink }}" integrity="{{ $allCSS.Data.Integrity }}">


  {{/* override theme by site data - or page parameters */}}
  {{ with $.Site.Data.theme }}  
    {{ $themeCss := "" }}
    {{ "<!-- theme overrides by site parameters -->" | safeHTML }}
    {{ "<style>" | safeHTML }}
      /** purgecss start ignore */

      {{ with .light }}
        {{ $themeCss = printf "%v\n:root {\n" $themeCss }}
          {{ range $key, $val := . }}
            {{ $themeCss = printf "%v--%v : %v;\n" $themeCss $key $val }}
          {{ end }}
        {{ $themeCss = printf "%v}\n" $themeCss }}
      {{ end }}

      {{ with .dark }}
        {{ $themeCss = printf "%v\nhtml.dark {\n" $themeCss }}
          {{ range $key, $val := . }}
            {{ $themeCss = printf "%v--%v : %v;\n" $themeCss $key $val }}
          {{ end }}
        {{ $themeCss = printf "%v}\n" $themeCss }}
      {{ end }}

      {{ $themeCss | safeHTML }}
      /** purgecss end ignore */
    {{ "</style>" | safeHTML }}
  {{ end }}

  {{ with .Params.theme }}
    {{ $themeCss := "" }}
    {{ "<!-- theme overrides by page parameters -->" | safeHTML }}
    {{ "<style>" | safeHTML }}
      /** purgecss start ignore */

      {{ with .light }}
        {{ $themeCss = printf "%v\n:root {\n" $themeCss }}
          {{ range $key, $val := . }}
            {{ $themeCss = printf "%v--%v : %v;\n" $themeCss $key $val }}
          {{ end }}
        {{ $themeCss = printf "%v}\n" $themeCss }}
      {{ end }}

      {{ with .dark }}
        {{ $themeCss = printf "%v\nhtml.dark {\n" $themeCss }}
          {{ range $key, $val := . }}
            {{ $themeCss = printf "%v--%v : %v;\n" $themeCss $key $val }}
          {{ end }}
        {{ $themeCss = printf "%v}\n" $themeCss }}
      {{ end }}

      {{ $themeCss | safeHTML }}
      /** purgecss end ignore */
    {{ "</style>" | safeHTML }}
  {{ end }}

</head>